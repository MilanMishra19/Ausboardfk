{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mishr/OneDrive/Desktop/ausboard/app/dashboard/projects/projects-overview/%5BprojectId%5D/testruns/page.tsx"],"sourcesContent":["\"use client\";\r\nimport Image from \"next/image\";\r\nimport Link from \"next/link\";\r\nimport { useParams } from \"next/navigation\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\nconst BACKEND_URL = process.env.NEXT_PUBLIC_API_URL;\r\n\r\ninterface TestCaseDetails {\r\n    id:string,\r\n    endpoints: string;\r\n    priority: string;\r\n    method: string;\r\n    title: string;\r\n    status?: string;\r\n    testType:string,\r\n}\r\ninterface TestRunResult {\r\n  id: string;\r\n  status: string;\r\n  response: string;\r\n  executionTime?: string;\r\n  runAt?: string;\r\n}\r\n\r\ninterface ProjectDetails {\r\n    name: string;\r\n    url: string;\r\n}\r\n\r\nexport default function TestcasesOverview() {\r\n  const [runningTests, setRunningTests] = useState<Set<string>>(new Set());\r\n    const { projectId } = useParams<{ projectId: string }>();\r\n    const [testCases, setTestCases] = useState<TestCaseDetails[]>([]);\r\n    const [project, setProject] = useState<ProjectDetails | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const fetchDetails = async () => {\r\n            if (!projectId) return;\r\n            try {\r\n                const [projectRes, tcRes] = await Promise.all([\r\n                    fetch(`${BACKEND_URL}/api/project/${projectId}`, { credentials: \"include\" }),\r\n                    fetch(`${BACKEND_URL}/api/testcase/project/${projectId}`, { credentials: \"include\" }),\r\n                ]);\r\n                const project = await projectRes.json();\r\n                const tc = await tcRes.json();\r\n                setProject(project);\r\n                setTestCases(Array.isArray(tc) ? tc : [tc]);\r\n            } catch (err) {\r\n                console.error('Error: ', err);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        }\r\n        fetchDetails();\r\n    }, [projectId]);\r\n    const handleSingleRun = async (testcaseId: string) => {\r\n      setRunningTests(prev => new Set(prev).add(testcaseId));\r\n  try {\r\n    const res = await fetch(`${BACKEND_URL}/api/testcase/run/${testcaseId}`, {\r\n      method: \"POST\",\r\n      credentials: \"include\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    });\r\n\r\n    if (!res.ok) {\r\n      const errorText = await res.text();\r\n      throw new Error(errorText || \"Failed to run test\");\r\n    }\r\n\r\n    const data = await res.json(); \r\n    alert(`Test ${data.status}: ${data.response?.substring(0, 100)}`);\r\n  } catch (err: unknown) {\r\n    const errorMsg = err instanceof Error ? err.message : \"Unknown error\";\r\n    console.error(err);\r\n    alert(`Error in running tests: ${errorMsg}`);\r\n  } finally {\r\n    setRunningTests(prev=>{\r\n      const updated = new Set(prev);\r\n      updated.delete(testcaseId);\r\n      return updated;\r\n    });\r\n  }\r\n};\r\n\r\n    const handleRunAll = async () => {\r\n      const allIds = testCases.map(tc => tc.id);\r\n      setRunningTests(new Set(allIds));\r\n  try {\r\n    const res = await fetch(`${BACKEND_URL}/api/testcase/run-all/${projectId}`, {\r\n      method: 'POST',\r\n      credentials: 'include'\r\n    });\r\n\r\n    if (!res.ok) {\r\n      throw new Error('Failed to run all tests');\r\n    }\r\n\r\n    const data: TestRunResult[] = await res.json();\r\n    const passed = data.filter((run) => run.status === 'PASSED').length;\r\n    alert(`âœ… ${passed}/${data.length} tests passed`);\r\n  } catch (err) {\r\n    console.error(err);\r\n    alert(`Failed to run all tests`);\r\n  } finally {\r\n    setRunningTests(new Set());\r\n  }\r\n};\r\n   const handleDelete = async(testcaseId:string)=>{\r\n    const confirmDelete = confirm(\"Are you sure you want to delete this testcase. Testruns associated with it too will be deleted.\");\r\n    if(!confirmDelete) return;\r\n    try{\r\n      const res = await fetch(`${BACKEND_URL}/api/testcase/${testcaseId}`,{\r\n        method:\"DELETE\",\r\n        credentials:\"include\"\r\n      });\r\n      if(!res.ok){\r\n        throw new Error(\"Failed to delete testcase\");\r\n      }\r\n      setTestCases(prev=>prev.filter(tc=>tc.id!==testcaseId));\r\n      alert(\"Testcase deleted successfully!\");\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert(\"An error occured while deleting your testcase.\");\r\n    }\r\n   }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-screen bg-black text-white\">\r\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-white mr-4\"></div>\r\n                <span className=\"tracking-widest text-sm\">Fetching your projects...</span>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"relative flex flex-col w-full gap-5\">\r\n<nav className=\"self-start flex px-5 py-3 text-white/30 border border-white/30 rounded-lg bg-transparent dark:bg-gray-800 dark:border-gray-700\" aria-label=\"Breadcrumb\">\r\n  <ol className=\"inline-flex items-center space-x-1 md:space-x-2 rtl:space-x-reverse\">\r\n    <li className=\"inline-flex items-center\">\r\n      <a href=\"/dashboard/projects/projects-overview\" className=\"inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white\">\r\n        Project Overview\r\n      </a>\r\n    </li>\r\n    <li>\r\n      <div className=\"flex items-center\">\r\n        <svg className=\"rtl:rotate-180 block w-3 h-3 mx-1 text-gray-400 \" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 6 10\">\r\n          <path stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"m1 9 4-4-4-4\"/>\r\n        </svg>\r\n        <a href={`/dashboard/projects/projects-overview/${projectId}/testcases`} className=\"ms-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ms-2 dark:text-gray-400 dark:hover:text-white\">Add Testcases</a>\r\n      </div>\r\n    </li>\r\n    <li aria-current=\"page\">\r\n      <div className=\"flex items-center\">\r\n        <svg className=\"rtl:rotate-180  w-3 h-3 mx-1 text-gray-400\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 6 10\">\r\n          <path stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"m1 9 4-4-4-4\"/>\r\n        </svg>\r\n        <span className=\"ms-1 text-sm font-medium text-gray-500 md:ms-2 dark:text-gray-400\">Testcase Overview</span>\r\n      </div>\r\n    </li>\r\n  </ol>\r\n</nav>\r\n            <div className=\"flex flex-col items-center justify-center gap-1\">\r\n            <h1 className=\"text-3xl tracking-widest text-white font-bold\">TESTCASES OVERVIEW</h1>\r\n            <h1 className=\"text-sm tracking-widest text-white/30 font-light\">{project?.name} : {project?.url}</h1>\r\n            </div>\r\n            <div className=\"flex w-full justify-between gap-5\">\r\n                 <div className=\"flex flex-col items-center justify-center rounded-2xl backdrop-blur-md shadow-xl border border-white/20 bg-gradient-to-br from-red-500 to-red-950 p-6 gap-2\">\r\n                <h1 className=\"text-xl text-red-950 drop-shadow-[0_0_10px_rgba(255,0,0,0.8)] font-bold\">Go to Testruns Overview</h1>\r\n                <Image src='/globe.svg' alt=\"\" height={500} width={500} className=\"object-cover h-12 w-12\"/>\r\n                <p className=\"text-sm text-white/50 font-light\">Find out if your tests passed, time taken to execute and much more in your Test runs overview.Additionally you can stress test as well as load test to find out metrics such as latency,throughput and much more</p>\r\n                <Link href={`/dashboard/projects/projects-overview/${projectId}/testruns/testruns-detail`}>\r\n                    <button className=\"w-45 py-2 px-4 text-white font-semibold rounded-md bg-red-600 shadow-[0_0_20px_rgba(255,0,0,0.7)] hover:shadow-[0_0_30px_rgba(255,0,0,1)] transition\">\r\n                    Go To Overview\r\n                    </button>\r\n                </Link>\r\n                </div>\r\n            </div>\r\n            <div className=\"overflow-x-auto rounded-lg shadow-lg border border-red-700\">\r\n                <button className=\"w-full py-2 px-4 text-white font-semibold rounded-md bg-red-600 shadow-[0_0_20px_rgba(255,0,0,0.7)] hover:shadow-[0_0_30px_rgba(255,0,0,1)] transition\" onClick={handleRunAll}>\r\n                    Run All\r\n                    </button>\r\n                <table className=\"w-full table-auto text-sm text-left text-gray-400\">\r\n                    <thead className=\"bg-[#1f1f1f] text-gray-300 uppercase text-xs\">\r\n                        <tr>\r\n                            <th className=\"px-6 py-3\">Title</th>\r\n                            <th className=\"px-6 py-3\">Endpoint</th>\r\n                            <th className=\"px-6 py-3\">Method</th>\r\n                            <th className=\"px-6 py-3\">Priority</th>\r\n                            <th className=\"px-6 py-3\">Test Type</th>\r\n                            <th className=\"px-6 py-3\">Decision</th>\r\n                            <th className=\"px-6 py-3\">Delete</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"bg-[#3f3939] text-center\">\r\n                        {testCases.length === 0 ? (\r\n                            <tr className=\"border-b border-gray-700 hover:bg-[#222222] transition duration-200\">\r\n                                <td colSpan={6} className=\"px-6 py-4 text-center\">No TestCases added</td>\r\n                            </tr>\r\n                        ) : (\r\n                            testCases.map((tc, index) => (\r\n                                <tr key={index} className=\"border-b border-gray-700 text-white hover:bg-[#222222] transition duration-200\">\r\n                                    <td className=\"px-6 py-4\">{tc.title}</td>\r\n                                    <td className=\"px-6 py-4\">{tc.endpoints}</td>\r\n                                    <td className=\"px-6 py-4\">{tc.method}</td>\r\n                                    <td className={`px-6 py-4 ${tc.priority==='low'?'text-green-500':tc.priority==='medium'?'text-yellow-500':'text-red-500'}`}>{tc.priority.toUpperCase()}</td>\r\n                                    <td className=\"px-6 py-4\">{(tc.testType)?.toLocaleUpperCase()}</td>\r\n                                    <td className=\"px-6 py-4\">\r\n                                          <button\r\n                                            className=\"text-sm text-blue-500 disabled:text-red-400 disabled:animate-pulse\"\r\n                                            onClick={() => handleSingleRun(tc.id)}\r\n                                            disabled={runningTests.has(tc.id)}\r\n                                          >\r\n                                            {runningTests.has(tc.id) ? \"Running...\" : \"Run\"}\r\n                                          </button>\r\n                                        </td>\r\n                                        <td className=\"px-6 py-4\">\r\n                                          <button className=\"text-red-500 text-sm hover:text-red-700\"\r\n                                          onClick={()=>handleDelete(tc.id)}>\r\n                                            Delete\r\n                                          </button>\r\n                                        </td>\r\n                                </tr>\r\n                            ))\r\n                        )}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}